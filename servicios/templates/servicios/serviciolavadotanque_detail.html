<!-- product_create_or_update.html -->

{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="container p-4" method="post" id="product_form">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="{% static 'scripts/generate_pdf.js' %}"></script>
  <button class="btn btn-primary" id="generatePdfBtn" onclick="generatePdfBtn('{{ servicio.cliente.razon_social}}' , '{{ servicio.id}}' )">Generar PDF</button>
    {% csrf_token %}
    <table class="card-header table table-bordered" border="0" cellpadding="0" cellspacing="0" id="sheet0" class="gridlines">
      <tbody>
        <tr>
          <td colspan="2" style="text-align:center;">
            <img src="{% static 'images/logo.png' %}" alt="Logo" width="50%">
          </td>
          <td colspan="2" style="text-align:center;">
            {{ infoEmpresas.nit }}<br>
            {{ infoEmpresas.direccion }}<br>
            Telefono: {{ infoEmpresas.telefono }} cel: {{ infoEmpresas.celular }}
          </td>
        </tr>

        <tr>
          <td colspan="3" style="text-align:center;">
            <b>
              {{ infoEmpresas.concepto_radicado }}<br>
              RADICADO {{ infoEmpresas.no_radicado }} FECHA: {{ infoEmpresas.fecha_radicado }}<br>
              TRD {{ infoEmpresas.TRD_radicado }}<br>
            </b>
          </td>
          <td  colspan="1" style="text-align:center;">
            <b>
              CERTIFICADO<br>
              DE CONTROL<br>
              NÂ° {{ servicio.id}}
            </b>
          </td>
        </tr>
        {% comment %} INFORMACION DEL CLIENTE {% endcomment %}
        <tr>
          <td colspan="3"><strong>RAZON SOCIAL:</strong> {{ servicio.cliente.razon_social}}</td>
          <td colspan="1"><strong>CONTACTO:</strong> {{ servicio.cliente.contacto}}</td>
        </tr>
        <tr>
          <td colspan="1"><strong>NIT</strong></td>
          <td colspan="1">{{ servicio.cliente.nit}}</td>
          <td colspan="1"><strong>DIRECCION:</strong><br> {{ servicio.cliente.direccion}}</td>
          <td colspan="1"><strong>TELEFONO:</strong> {{ servicio.cliente.telefono}}</td>
        </tr>
        {% comment %} FECHA DE EJECUCION {% endcomment %}
        <tr>
          <td  colspan="1"><br><strong>FECHA EJECUCION</strong> </td>
          <td  colspan="1"><br>{{ servicio.fecha_ejecucion }}</td>
          <td  colspan="1"><br><strong>FECHA VENCIMIENTO</strong> </td>
          <td  colspan="1"><br>{{ servicio.fecha_vencimiento }}</td>
        </tr>
        <tr> 
          <td  colspan="6" style="text-align:center;"><strong>PROCEDIMIENTO BASICO</strong>
        </tr>
        <tr> 
          <td colspan="6" style="text-align:center;">{{ infoEmpresas.procedimiento_basico }}</td>
        </tr>
        {% for tanque in tanques %}
        <tr>
          <td  colspan="6" style="text-align:center;"><br><strong>TANQUE NUMERO {{tanque.id}}</strong> </td>

        </tr>
        <tr>
          <td  colspan="2" style="text-align:center;"><strong>IDENTIFICACION DEL TANQUE</strong> </td>

          <td  colspan="2" style="text-align:center;"><strong>FACTORES DE RIESGO</strong></td>
        </tr>
        <tr>
          <td  colspan="1" style="text-align:center;"><strong>UBICACION DEL TANQUE</strong></td>
          <td  colspan="1" style="text-align:center;"> {{tanque.ubicacion_tanque}}</td>
          <td  colspan="1" style="text-align:center;"><strong>ESTADO INTERNO DEL TANQUE</strong></td>
          <td  colspan="1" style="text-align:center;">{{tanque.estado_interno_tanque}}</td>
        </tr>
        <tr>
          <td  colspan="1" style="text-align:center;"><strong>MATERIAL DEL TANQUE</strong></td>
          <td  colspan="1" style="text-align:center;"> {{tanque.material_tanque}}</td>
          <td  colspan="1" style="text-align:center;"><strong>ESTADO TUBERIAS</strong></td>
          <td  colspan="1" style="text-align:center;">{{tanque.estado_tuberias}}</td>
        </tr>
        <tr>
          <td  colspan="1" style="text-align:center;"><strong>VOLUMEN DE ALMACENAMIENTO</strong></td>
          <td  colspan="1" style="text-align:center;"> {{tanque.volumen_almacenamiento}}</td>
          <td  colspan="1" style="text-align:center;"><strong>ESTADO EMPAQUE</strong></td>
          <td  colspan="1" style="text-align:center;">{{tanque.estado_empaque}} </td>
        </tr>
        <tr>
          <td  colspan="1" style="text-align:center;"><strong>HERMETICIDAD</strong></td>
          <td  colspan="1" style="text-align:center;"> {{tanque.hermeticidad_tanque}}</td>
          <td  colspan="1" style="text-align:center;"><strong>UNIDAD DE MEDIDA</strong></td>
          <td  colspan="1" style="text-align:center;"> {{tanque.unidad_medida}}</td>
        </tr>
        <tr>
          {% if tanque.otra_ubicacion_tanque %}
          <td  colspan="1" style="text-align:center;"><strong>OTRA UBICACION</strong></td>
          <td  colspan="1" style="text-align:center;"> {{ tanque.otra_ubicacion_tanque }}</td>
          {% endif %}
          {% if tanque.otro_material_tanque %}
          <td  colspan="1" style="text-align:center;"><strong>OTRO MATERIAL</strong></td>
          <td  colspan="1" style="text-align:center;"> {{ tanque.otro_material_tanque }}</td>
          {% endif %}
        </tr>

        <tr>
          <td  colspan="1" style="text-align:center;"><strong>OBSERVACIONES</strong></td>
          <td  colspan="4" style="text-align:center;"> {{tanque.observaciones}}</td>
        </tr>
        {% endfor %}
        <tr> 
          <td  colspan="6" style="text-align:center;"><br><strong>ANEXOS GENERALES</strong>
        </tr>
        <tr>
            {% for anexo in anexos %}
            <td colspan="2" style="text-align:center;">
              <img src="{{ anexo.imagen.url }}" alt="Imagen del anexo" style="max-width: 250px; max-height: 100%;">
              <br>
              {{anexo.descripcion}}
            </td>
            {% if forloop.counter|divisibleby:2 %}</tr><tr>{% endif %}
            {% endfor %}
          
        
        </tr>

        <tr>
          <td colspan="2"><strong>TECNICO APLICADOR </strong></td>
          <td colspan="2"><strong>FIRMA</strong>
            {% if firma %}
              <img src="{{ firma.0.imagen.url }}" alt="Imagen de firma" style="max-width: 250px; max-height: 100%;">
            {% else %}
              <form action=" {% url "guardar_firma_lavado" servicio.id %}" method="POST" id="firmaForm" enctype="multipart/form-data">
                {% csrf_token %}
                <input class="form-control" type="file" id="formFile" name='imagen' accept="image/*" onchange="previewFirma()" style="width: 221px;">
                <img id="firmaPreview" style="max-width: 250px; max-height: 100%;">
                <button class="btn btn-primary d-none" id="guardarFirma">Guardar Firma</button>
              </form>

            {% endif %}
          </td>
        </tr>
        <tr style="text-align:center;">
          <td colspan="6">
            <b>
              {{ infoEmpresas.agradecimiento }}<br>
              {{ infoEmpresas.compromiso }}<br>
              {{ infoEmpresas.correo }} / {{ infoEmpresas.pagina_web }}<br>
            </b>
          </td>
        </tr>
        

    </table> 
{% endblock content %}
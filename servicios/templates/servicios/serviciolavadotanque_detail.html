<!-- product_create_or_update.html -->

{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="container p-4" method="post" id="product_form">
  <style>
    .table {
        width: 200%;
        margin-bottom: 1rem;
        color: #212529;
        border-collapse: collapse;
    }
    .table th,
    .table td {
        padding: 0.75rem;
        vertical-align: top;
        border-top: 1px solid #333;
    }
    .table thead th {
        vertical-align: bottom;
        border-bottom: 2px solid #333;
    }
    .table tbody + tbody {
        border-top: 2px solid #333;
    }
    .table .table {
        background-color: #fff;
    }
    .table-bordered {
        border: 1px solid #333;
    }
    .table-bordered th,
    .table-bordered td {
        border: 1px solid #333;
    }
    .table-bordered thead th,
    .table-bordered thead td {
        border-bottom-width: 2px;
    }
    .text-center {
        text-align: center !important;
    }
    .p-4 {
        padding: 1.5rem !important;
    }
    .gridlines {
        border-collapse: collapse;
        border: 1px solid black;
    }
    .gridlines td, .gridlines th {
        border: 1px solid black;
        padding: 8px;
    }
    .title-cell {
      background-color: #DBE0F4 !important;
    }
    .title-blue {
      background-color: #8EA9DE !important;
    }
    .table {
      font-size: 16px;
  }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="{% static 'scripts/generate_pdf.js' %}"></script>
  <button class="btn btn-primary" id="generatePdfBtn" onclick="generatePdfBtn('{{ servicio.cliente.razon_social}}' , '{{ servicio.id}}' )">Generar PDF</button>
    {% csrf_token %}
    <table class="card-header table table-bordered" border="0" cellpadding="0" cellspacing="0" id="sheet0" class="gridlines">
      <tbody>
        <tr>
          <td colspan="2" style="text-align:center;">
            <img src="{% static 'images/logo.png' %}" alt="Logo" width="50%">
            {% if exclude %}
            <img src="{{ logo_url }}" alt="Logo" width="50%">
            {% endif %}
          </td>
          <td colspan="2" style="text-align:center;">
            {{ infoEmpresas.nit }}<br>
            {{ infoEmpresas.direccion }}<br>
            Telefono: {{ infoEmpresas.telefono }} cel: {{ infoEmpresas.celular }}
          </td>
        </tr>

        <tr>
          <td colspan="3" style="text-align:center;">
            <b>
              {{ infoEmpresas.concepto_radicado }}<br>
              RADICADO {{ infoEmpresas.no_radicado }} FECHA: {{ infoEmpresas.fecha_radicado }}<br>
              TRD {{ infoEmpresas.TRD_radicado }}<br>
            </b>
          </td>
          <td  colspan="1" style="text-align:center;">
            <b>
              CERTIFICADO<br>
              DE CONTROL<br>
              NÂ° {{ servicio.id}}
            </b>
          </td>
        </tr>
        {% comment %} INFORMACION DEL CLIENTE {% endcomment %}
        <tr>
          <td colspan="2"><strong>RAZON SOCIAL:</strong> {{ servicio.cliente.razon_social}}</td>
          <td colspan="2"><strong>CONTACTO:</strong> {{ servicio.cliente.contacto}}</td>
        </tr>
        <tr>
          <td colspan="1"><strong>NIT</strong></td>
          <td colspan="1">{{ servicio.cliente.nit}}</td>
          <td colspan="1"><strong>DIRECCION:</strong><br> {{ servicio.cliente.direccion}}</td>
          <td colspan="1"><strong>TELEFONO:</strong> {{ servicio.cliente.telefono}}</td>
        </tr>
        {% comment %} FECHA DE EJECUCION {% endcomment %}
        <tr>
          <td  colspan="1"><strong>FECHA EJECUCION</strong> </td>
          <td  colspan="1">{{ servicio.fecha_ejecucion }}</td>
          <td  colspan="1"><strong>FECHA VENCIMIENTO</strong> </td>
          <td  colspan="1">{{ servicio.fecha_vencimiento }}</td>
        </tr>
        <tr> 
          <td  class="title-cell" colspan="6" style="text-align:center;"><strong>PROCEDIMIENTO BASICO</strong>
        </tr>
        <tr> 
          <td class="title-cell" colspan="6" style="text-align:center;">{{ infoEmpresas.procedimiento_basico }}</td>
        </tr>
        {% for tanque in tanques %}
        <tr>
          <td  class="title-blue" colspan="6" style="text-align:center;"><strong>TANQUE NUMERO {{tanque.id}}</strong> </td>

        </tr>
        <tr>
          <td  class="title-blue" colspan="2" style="text-align:center;"><strong>IDENTIFICACION DEL TANQUE</strong> </td>

          <td  class="title-blue" colspan="2" style="text-align:center;"><strong>FACTORES DE RIESGO</strong></td>
        </tr>
        <tr>
          <td  colspan="1" style="text-align:center;"><strong>UBICACION DEL TANQUE</strong></td>
          <td  colspan="1" style="text-align:center;"> {{tanque.ubicacion_tanque}}</td>
          <td  colspan="1" style="text-align:center;"><strong>ESTADO INTERNO DEL TANQUE</strong></td>
          <td  colspan="1" style="text-align:center;">{{tanque.estado_interno_tanque}}</td>
        </tr>
        <tr>
          <td  colspan="1" style="text-align:center;"><strong>MATERIAL DEL TANQUE</strong></td>
          <td  colspan="1" style="text-align:center;"> {{tanque.material_tanque}}</td>
          <td  colspan="1" style="text-align:center;"><strong>ESTADO TUBERIAS</strong></td>
          <td  colspan="1" style="text-align:center;">{{tanque.estado_tuberias}}</td>
        </tr>
        <tr>
          <td  colspan="1" style="text-align:center;"><strong>VOLUMEN DE ALMACENAMIENTO</strong></td>
          <td  colspan="1" style="text-align:center;"> {{tanque.volumen_almacenamiento}}</td>
          <td  colspan="1" style="text-align:center;"><strong>ESTADO EMPAQUE</strong></td>
          <td  colspan="1" style="text-align:center;">{{tanque.estado_empaque}} </td>
        </tr>
        <tr>
          <td  colspan="1" style="text-align:center;"><strong>HERMETICIDAD</strong></td>
          <td  colspan="1" style="text-align:center;"> {{tanque.hermeticidad_tanque}}</td>
          <td  colspan="1" style="text-align:center;"><strong>UNIDAD DE MEDIDA</strong></td>
          <td  colspan="1" style="text-align:center;"> {{tanque.unidad_medida}}</td>
        </tr>
        <tr>
          {% if tanque.otra_ubicacion_tanque %}
          <td  colspan="1" style="text-align:center;"><strong>OTRA UBICACION</strong></td>
          <td  colspan="1" style="text-align:center;"> {{ tanque.otra_ubicacion_tanque }}</td>
          {% endif %}
          {% if tanque.otro_material_tanque %}
          <td  colspan="1" style="text-align:center;"><strong>OTRO MATERIAL</strong></td>
          <td  colspan="1" style="text-align:center;"> {{ tanque.otro_material_tanque }}</td>
          {% endif %}
        </tr>

        <tr>
          <td  colspan="1" style="text-align:center;"><strong>OBSERVACIONES</strong></td>
          <td  colspan="4" style="text-align:center;"> {{tanque.observaciones}}</td>
        </tr>
        {% endfor %}
        <tr> 
          <td  class="title-cell" colspan="6" style="text-align:center;"><strong>ANEXOS GENERALES</strong>
        </tr>
        <tr>
            {% for anexo in anexos %}
            <td colspan="2" style="text-align:center;">
              <img src="{{ anexo.imagen.url }}" alt="Imagen del anexo" style="max-width: 250px; max-height: 100%;">
              <br>
              {{anexo.descripcion}}
            </td>
            {% if forloop.counter|divisibleby:2 %}</tr><tr>{% endif %}
            {% endfor %}
          
        
        </tr>

        <tr>
          <td colspan="2"><strong>TECNICO APLICADOR: </strong> <br> {{tecnico}}</td>
          <td  class="title-cell" colspan="2"><strong>FIRMA DE RECIBIDO</strong>
            {% if firma %}
              <img src="{{ firma.0.imagen.url }}" alt="Imagen de firma" style="max-width: 250px; max-height: 100%;">
            {% endif %}
            {% if exclude and firma_url %}
              <img src="{{ firma_url }}" alt="Firma" class="firma">
            {% endif %}
            {% if not firma and not firma_url%}
              <form action=" {% url "guardar_firma_lavado" servicio.id %}" method="POST" id="firmaForm" enctype="multipart/form-data">
                {% csrf_token %}
                <input class="form-control" type="file" id="formFile" name='imagen' accept="image/*" onchange="previewFirma()" style="width: 221px;">
                <img id="firmaPreview" style="max-width: 250px; max-height: 100%;">
                <button class="btn btn-primary d-none" id="guardarFirma">Guardar Firma</button>
              </form>

            {% endif %}
          </td>
        </tr>
        <tr style="text-align:center;">
          <td colspan="4">
            <b>
              {{ infoEmpresas.agradecimiento }}<br>
              {{ infoEmpresas.compromiso }}<br>
              {{ infoEmpresas.correo }} / {{ infoEmpresas.pagina_web }}<br>
            </b>
          </td>
        </tr>
        

    </table> 
{% endblock content %}